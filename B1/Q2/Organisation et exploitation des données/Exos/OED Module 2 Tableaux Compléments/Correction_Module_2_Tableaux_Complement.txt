module(fiche;;ficheJouet,ficheExiste)
---*
Obtenir ficheJouet.reference
ficheExiste = ficheJouet.reference ≠ "XXX"
if(ficheExiste)
Obtenir ficheJouet.nom
Obtenir ficheJouet.prix
Obtenir ficheJouet.nbStock
i = 0
Obtenir libMateriau
while (i < 5 AND libMateriau != "ZZZ")
ficheJouet.matériaux[i]=libMateriau
Obtenir libMateriau
i++
endwhile
while (i < 5)
ficheJouet.matériaux[i]=" "
i++
endwhile
------

module(indiceJouet;jouets, nbJouets,referenceJouet;iJouet)
---* indiceJouet
iJouet = 0
while (iJouet < nbJouets AND referenceJouet > jouets[iJouet].reference)
iJouet ++
endwhile
------
module(decalageDroitJouets;jouets,nbJouets,iJouet;jouets,nbJouets)
---* decalageJouets
iDecal = nbJouets
while (iDecal > iJouet)
jouets[iDecal] = jouets[iDecal-1]
iDecal --
endwhile
nbJouets++
------


module(miseAJourJouets;jouets,nbJouets;ouets,nbJouets)

---* miseAJjourJouets
module(fiche;;ficheJouet,ficheExiste)
while (ficheExiste)
module(indiceJouet;jouets,nbJouets,ficheJouet.reference;iJouet)
if (iJouet == nbJouets OR ficheJouet.reference < jouets[iJouet].reference)
module(decalageDroitJouets;jouets,nbJouets,iJouet;jouets,nbJouets)
endif
jouets[iJouet] = ficheJouet
module(fiche;;ficheJouet,ficheExiste)
endwhile
------

module(decalageGaucheJouets;jouets,nbJouets,iJouet;jouets,nbJouets)

---* decalageGaucheJouets

nbJouets--
while (iJouet < nbJouets)
jouets[iJouet] = jouets[iJouet+1]
iJouet++
endwhile

------




module(suppressionJouet;jouets,nbJouets,referenceJouet;jouets,nbJouets,estSupprimé)

---* suppressionJouet
module(indiceJouet;jouets,nbJouets,referenceJouet;iJouet)

estSupprimé = iJouet < nbJouets AND referenceJouet == jouets[iJouet].reference

if(estSupprimé)
module(decalageGaucheJouets;jouets,nbJouets,iJouet;jouets,nbJouets)
endif
------

module(indiceMateriau;materiauxJouets,libelleMateriau;iMateriau)

---* indiceMateriau
iMateriau = 0
while (iMateriau < 5 AND materiauxJouets[iMateriau] != " " AND materiauxJouets[iMateriau] != libelleMateriau)
iMateriau ++
endwhile
------

module(suppressionMatériauJouet;jouets,nbJouets,referenceJouet,libelleMateriau;jouets)

---* suppressionMatériauJouet
module(indiceJouet;jouets,nbJouets,ficheJouet.reference;iJouet)
if (iJouet == nbJouets OR referenceJouet < jouets[iJouet].reference)
sortir "Jouet inexistant"
else
module(indiceMateriau;jouets[iJouet].materiaux,libelleMateriau;iMateriau)
if (iMateriau == 5 OR jouets[iJouet].materiaux[iMateriau] == " " OR jouets[iJouet].materiaux[iMateriau] !=libelleMateriau)
sortir "Materiau inexistant"
else

endif
endif
------
