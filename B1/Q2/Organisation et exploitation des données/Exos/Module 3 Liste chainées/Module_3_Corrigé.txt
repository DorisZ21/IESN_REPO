//Exercices Dorian Michaux

// EX3 a
module(miseAJourPrix;reference,prix,pDebutJouets;)
---*
pJouet = pDebutJouets  //Ne pas mettre de s à pJouet !!!! A corriger pour la suite dans tous les DA
while(pJouets != NULL AND reference != pJouets->reference)
  pJouets = pJouets->pSuiv
endwhile

if(pJouets == NULL)
  sortir "Le jouet n'est pas repris dans la liste"
else
  if(pJouets->prix != prix)
    pJouets->prix = prix
  else
    sortir "Le prix du jouet n'est pas différent"
  endif 
// + simple, modifier quoi qu'il arrive pour éviter une condition inutile
endif
------

// EX3 b

module(nbJouetsPlus50;pDebutJouets;nbJouetsPlus50)
---*
nbJouetsPlus50 = 0
pJouets = pDebutJouets
while(pJouets != NULL)
 if(pJouets->prix > 50)
     nbJouetsPlus50++
 endif
 pJouets = pJouets->pSuiv
endwhile
------

// Ex3 C

module(afficheReferenceInferieurAPrix;pDebutJouets,prix;)
---*
prixJouetMoinsCher = HV
pJouets = pDebutJouets
while(pJouets != NULL)
// Je pars du principe qu'on peut sortir la référence du jouet le moins cher même si il n'est pas 
// moins cher que le prix rentré en paramètre  --> c'est évident !
if(pJouets->prix < prixJouetMoinsCher)
  prixJouetMoinsCher = pJouets->prix
  referenceJouetMoinsCher = pJouets->reference
endif
 if(pJouets->prix < prix)
   sortir pJouets->reference
  endif 
 pJouets = pJouets-pSuiv
endwhile
------

// Ex3 D non fait ! retourner versus afficher 3 C

// Ex3 E

// nbJouetsParPrix { cell (5*) { prix, quantite
//tableau à initialiser par tes soins !
//N'y a-t-il pas moyen d'utiliser un tableau simple à la place d'un tableau de structure ?
//--> simplification démarche
module(afficheJouetsParPrix;pDebutJouets;)
---*
pJouets = pDebutJouets
while(pDebutJouets != null)
iPrix = 0
  while(iPrix < 5)
    if(pJouets->prix < nbJouetsParPrix[iprix].prix)
      nbJouetsParPrix[iPrix].quantite++
    endif
    iPrix++
  endwhile
pJouets = pDebutJouets->pSuiv
endwhile

iNbJouets = 0  //pas de s au nom d'un indice !
while(iNbJouets < 5)
  sortir nbJouetsParPrix[iNbJouets].quantite
sortir 
iNbJouets++
endwhile
--------



// EX 4 CAS 1

// articles { cell (nbArticles*) { reference
//                                 quantite


module(infosClients;pDebutClient;)
---*
// quantiteMax = LV --> à initialiser au début de la boucle principale ! pour chaque client !
pClient = pDebutClient
while (pClient != null)
  sortir pClient->numCarte
  nbArticles = pClient->nbArticles
  iArticle = 0
  while(iArticle < nbArticles)
    sortir pClient->articles[iArticle].reference, pClient->articles[iArticle].quantite
    if(pClient->articles[iArticle].quantite > quantiteMax)
        quantiteMax = pClient->articles[iArticle].quantite
        refArticlePlusAchete = pClient->articles[iArticle].reference 
    endif
    iArticle++
  endwhile
  sortir refArticlePlusAchete
  pClient = pClient->pSuiv
endwhile
------

// EX 4 CAS 2

// Bloc logique sur les clients

module(infosAchats;pDebutAchats;)
---*
quantiteMax = LV  //idem supra CAS 1
pAchat = pDebutAchats
while(pAchat != null)
  clientEnCours = pAchat->numCarte
  sortir clientEnCours
  while(pAchat != null && pAchat->numCarte == clientEnCours)
    sortir pAchat->reference
    sortir pAchat->quantite
    if(pAchat->quantite > quantiteMax)
      quantiteMax = pAchat->quantite
      refArticlePlusAchete = pAchat->reference
    endif
    pAchat = pAchat->pSuiv
  endwhile
sortir refArticlePlusAchete
endwhile
------

// EX 5
module(ajoutDebutListe;pDebutJouets;)
---*
module(ficheObtenue;;fiche,ficheExiste)
if(ficheExiste)
  pNouvJouet =  adresse mémoire nouveau chainon
  if(pNouvJouet != NULL)
    pNouvJouet->reference = fiche.reference
    pNouvJouet->nom = fiche.nom
    pNouvJouet->prix = fiche.prix
    pNouvJouet->nbExemplaires = fiche.nbExemplaires
    pNouvJouet->pSuiv = pDebutJouets
    pDebutJouets = pNouvJouet
  else
    sortir "Mémoire insuffisante"
  endif
else
  sortir "Veuillez entrez des informations valides"
endif
------

module(ajoutFinListe;pDebutJouets;)
---*
module(ficheObtenue;;fiche,ficheExiste)
if(ficheExiste)
  pNouvJouet =  adresse mémoire nouveau chainon
  if(pNouvJouet != NULL)
    pNouvJouet->reference = fiche.reference
    pNouvJouet->nom = fiche.nom
    pNouvJouet->prix = fiche.prix
    pNouvJouet->nbExemplaires = fiche.nbExemplaires
    pJouet = pDebutJouets
    while(pJouet != NULL)
      pJouetPrecedent = pJouet
      pJouet = pJouet->pSuiv
    endwhile
    pJouetPrecedent->pSuiv = pNouvJouet
    pNouvJouet->pSuiv = null
  else
    sortir "Mémoire insuffisante"
  endif
else
  sortir "Veuillez entrez des informations valides"
endif
------

